## 1. Implementation

- [ ] 1.1 Implement Arrow schema (de)serialization for catalog storage
- [ ] 1.2 Implement schema comparison and merge logic with promotion rules
- [ ] 1.3 Implement `schema_merge` and type promotion configuration flags
- [ ] 1.4 Integrate schema management into `write_dataset` before files are written
- [ ] 1.5 Update catalog writes to create new `schema_versions` entries and link files to schema versions
- [ ] 1.6 Add tests for adding columns, type promotion, and strict mode failures

